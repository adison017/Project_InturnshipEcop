<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wazuh Launcher</title>
    <link rel="icon" href="logo_transparent.png" />

    <!-- Libraries -->
    <script type="text/javascript" src="/eel.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@300;400;500;600;700&family=Kanit:wght@300;400;500;600;700&family=Pixelify+Sans:wght@400..700&family=Sarabun:wght@300;400;500;600;700&family=Silkscreen:wght@400;700&display=swap"
      rel="stylesheet"
    />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/styles.css" />
  </head>

  <body
    class="bg-slate-950 text-white h-screen flex items-center justify-center selection:bg-sky-500 selection:text-white overflow-hidden relative"
  >
    <!-- Global Loader -->
    <div id="global-loader" class="fixed inset-0 z-50 bg-slate-950 flex flex-col items-center justify-center transition-opacity duration-500">
        <div class="relative">
            <div class="w-16 h-16 border-4 border-slate-800 rounded-full"></div>
            <div class="absolute top-0 w-16 h-16 border-4 border-sky-500 border-t-transparent rounded-full animate-spin"></div>
        </div>
        <p class="mt-4 text-slate-400 font-light tracking-widest text-sm animate-pulse">กำลังเริ่มต้นระบบ...</p>
    </div>

    <!-- Main Container -->
    <div
      id="app"
      class="animate-enter w-[98%] max-w-none h-[98%] rounded-2xl p-5 grid grid-cols-5 gap-5 relative overflow-hidden"
    >

      <!-- LEFT COLUMN: Logo, Terminal & Virtual Machine Control -->
      <div class="col-span-3 flex flex-col justify-between space-y-3 bg-slate-900/50 backdrop-blur-sm rounded-xl p-4 border border-white/10">
        <!-- Header -->
        <div id="header-container"></div>

        <!-- Terminal -->
        <div id="terminal-container" class="flex-1"></div>

        <!-- Virtual Machine Control Button -->
        <div id="vm-control-container" class="flex flex-col items-center justify-center space-y-2">
          <button id="btn-vm-toggle" 
            class="group relative w-14 h-14 rounded-full bg-slate-800/60 border-2 border-slate-600/50 hover:border-emerald-500/70 transition-all duration-300 flex items-center justify-center shadow-lg hover:shadow-emerald-500/20 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed"
            title="เปิด/ปิด Virtual Machine"
            disabled>
            <!-- Power Icon (default - VM stopped, green) -->
            <svg id="icon-power-off" class="w-7 h-7 text-emerald-400 group-hover:text-emerald-300 transition-colors" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M5.636 5.636a9 9 0 1012.728 0M12 3v9"/>
            </svg>
            <!-- Power Icon (hidden - VM running, red) -->
            <svg id="icon-power-on" class="w-7 h-7 text-red-400 group-hover:text-red-300 transition-colors hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M5.636 5.636a9 9 0 1012.728 0M12 3v9"/>
            </svg>
            <!-- Loading Spinner -->
            <div id="icon-loading" class="w-6 h-6 border-2 border-sky-500 border-t-transparent rounded-full animate-spin hidden"></div>
          </button>
          <span id="vm-status-text" class="text-xs font-medium text-slate-500 tracking-wide">Checking...</span>
        </div>
      </div>

      <!-- RIGHT COLUMN: Step Wizard -->
      <div class="col-span-2 flex flex-col justify-between relative overflow-hidden" id="wizard-container">
        <!-- Wizard will be mounted here -->
      </div>

      <!-- Footer -->
      <div id="footer-container"></div>
    </div>

    <!-- Application Logic -->
    <script type="module" src="js/main.js"></script>

    <!-- Component Mounting -->
    <script type="module">
      import Header from "./js/components/Header.js";
      import Terminal from "./js/components/Terminal.js";
      import Footer from "./js/components/Footer.js";
      import StepWizard from "./js/components/StepWizard.js";

      // Mount Static Components
      document.getElementById("header-container").innerHTML = Header();
      document.getElementById("terminal-container").innerHTML = Terminal();
      document.getElementById("footer-container").innerHTML = Footer();

      // Initialize Wizard after a short delay for Eel to be ready
      setTimeout(() => {
        const wizard = new StepWizard("wizard-container");
        wizard.init();
        window.wizard = wizard; // Expose globally for debugging
      }, 600);
    </script>
  </body>
</html>
